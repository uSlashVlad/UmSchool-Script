// ==UserScript==
// @name         Umschool script
// @namespace    http://tampermonkey.net/
// @version      0.5.1 beta
// @description  Скрипт для того, чтобы запускать вебинары на ютубе
// @author       https://vk.com/id227730745
// @match        https://new.umschool.net/*
// @grant        none
// ==/UserScript==
var url=document.URL;url=url.split("//")[1].split("/");var button_main_style=".yt_button_script {background-color: #be2413; border: none; border-radius: 4px; color: white; padding: 5px 10.5px; margin-top: 7.5px; text-align: center; text-decoration: none; display: inline-block; font-size: 18px; font-weight: bold;} .yt_button_script:hover {background-color: #df3c2a;} .yt_button_script:active {background-color: #d96154;}",button_down_style=".yt_button_down_script {background-color: #21c809; border: none; border-radius: 4px; color: white; padding: 5px 10.5px; margin-top: 7.5px; text-align: center; text-decoration: none; display: inline-block; font-size: 18px; font-weight: bold;} .yt_button_down_script:hover {background-color: #4de038;} .yt_button_down_script:active {background-color: #8edd83;}",bear_image_new_src="https://i.ibb.co/G089qYZ/bear-icon.png",hm_my_style="hr {display: none} .exercise-item {background-color: #f7f6f6; padding: 15px; /*border: 0.5px solid #E6E6E6;*/ border-radius: 20px;}.float-right {float: none !important}.form-control[readonly] {border: 2px #43B15D solid}.form-control[style=\"background-color: #dc3545; color: #ffffff\"] {border: 2px #b14b43 solid;}.form-control[style=\"background-color: rgb(220, 53, 69); color: rgb(255, 255, 255); --darkreader-inline-bgcolor:#86272e; --darkreader-inline-color:#ffffff;\"] {border: 2px #b14b43 solid;}",scroll_custom_style="::-webkit-scrollbar-button { background-image:url(\"\"); background-repeat:no-repeat; width:6px; height:0px } ::-webkit-scrollbar-track { background-color:#f5f4f3; } ::-webkit-scrollbar-thumb { webkit-border-radius: 5px; border-radius: 5px; background-color:#F19137; box-shadow:0px 1px 1px #fff inset; background-image:url(\"https://yraaa.ru/_pu/24/59610063.png\"); background-position:center; background-repeat:no-repeat; } ::-webkit-resizer{ background-image:url(\"\"); background-repeat:no-repeat; width:7px; height:0px } ::-webkit-scrollbar{ width: 11px; }",xp_levels=[0,200,700,1500,2350,4350,5200,6050,6900,7750,9750],autoloading=!1;getCookie("settings_autoloading")&&(autoloading=!("1"!=getCookie("settings_autoloading")));var experiment=!1;getCookie("settings_experimental")&&(experiment=!("1"!=getCookie("settings_experimental")));var src,clock,timer=1.5,initial_timer=0,styles="";if("mastergroup"==url[1]&"lessons"==url[2]&(""==url[4]|"#"==url[4])){let a=document.body.getElementsByClassName("preview-title")[0];if(a||(a=document.body.getElementsByClassName("date-container")[0]),a){styles+=button_main_style,a.innerHTML+="<br><input class=\"yt_button_script\" type=\"button\" value=\"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0432\u0435\u0431\u0438\u043D\u0430\u0440 \u043D\u0430 \u044E\u0442\u0443\u0431\u0435\"> ","preview-title"==a.classList[0]&experiment&&(styles+=button_down_style,a.innerHTML+="<input class=\"yt_button_down_script\" type=\"button\" value=\"\u0421\u043A\u0430\u0447\u0430\u0442\u044C \u0432\u0435\u0431\u0438\u043D\u0430\u0440 [\u03B2]\" style=\"margin-left: 10px;\"> ");var button=a.getElementsByClassName("yt_button_script")[0];if(experiment)var button_down=a.getElementsByClassName("yt_button_down_script")[0]}autoloading&&(clock=setTimeout(yt_start,1e3*timer)),button&&(button.onclick=function(){yt_start()}),button_down&experiment&&(button_down.onclick=function(){yt_download()})}else if("core"==url[1]&"profile"==url[2]&"edit"==url[3]){let a=document.body.getElementsByClassName("content")[0];if(a){var html="";if(html+="<h3><b>\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 Umschool script</b></h3>",html+="<input class=\"settings_autoloading_toggler\" type=\"checkbox\"> \u0410\u0432\u0442\u043E\u0437\u0430\u043F\u0443\u0441\u043A \u0432\u0435\u0431\u0438\u043D\u0430\u0440\u043E\u0432 \u043D\u0430 \u044E\u0442\u0443\u0431\u0435",html+="<br><input class=\"settings_experimental_toggler\" type=\"checkbox\"> \u042D\u043A\u0441\u043F\u0435\u0440\u0438\u043C\u0435\u043D\u0442\u0430\u043B\u044C\u043D\u044B\u0435 \u0444\u0443\u043D\u043A\u0446\u0438\u0438",html+="<br><a href=\"https://vk.com/id227730745\" target=\"_blank\" style=\"color: #f19137\">\u041F\u043E \u0432\u0441\u0435\u043C \u0431\u0430\u0433\u0430\u043C \u0438 \u0432\u043E\u043F\u0440\u043E\u0441\u0430\u043C \u043F\u0438\u0441\u0430\u0442\u044C \u0441\u044E\u0434\u0430.</a>",experiment)var html_ex="";a.innerHTML+=html;var autoloading_toggler=a.getElementsByClassName("settings_autoloading_toggler")[0];autoloading_toggler.checked=autoloading;var experimental_toggler=a.getElementsByClassName("settings_experimental_toggler")[0];experimental_toggler.checked=experiment}autoloading_toggler&&(autoloading_toggler.onclick=function(){autoloading_toggle()}),experimental_toggler&&(experimental_toggler.onclick=function(){experimental_toggle()})}else("mastergroup"==url[1]&"lessons"==url[2]&"homework"==url[4]|"homework"==url[1]&"submissions"==url[2])&experiment&&(styles+=hm_my_style);if("core"==url[1]&"hw"==url[2]&"my"==url[3])document.title="\u0414\u043E\u043C\u0430\u0448\u043D\u0438\u0435 \u0437\u0430\u0434\u0430\u043D\u0438\u044F";else if("mastergroup"!=url[1])"teacher"==url[1]?document.title="\u041F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u0438":"core"==url[1]?"profile"==url[2]?document.title="\u0413\u043B\u0430\u0432\u043D\u0430\u044F \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430":"loyalty"==url[2]&&(document.title="\u041C\u043E\u0438 \u0434\u043E\u0441\u0442\u0438\u0436\u0435\u043D\u0438\u044F"):"course"==url[1]&&(document.title="\u041A\u0443\u0440\u0441\u044B");else if("lessons"!=url[2])document.title="\u041C\u0430\u0441\u0442\u0435\u0440-\u0433\u0440\u0443\u043F\u043F\u044B";else if(""==url[4]|"#"==url[4])document.title="\u0417\u0430\u043D\u044F\u0442\u0438\u0435";else if("homework"==url[4]){let a=document.body.getElementsByClassName("text-container")[0].children[0];a=a.innerHTML.split(" (")[0],document.title=a}var bear_image=document.body.getElementsByClassName("bear-notifier-img")[0];if(bear_image.src=bear_image_new_src,experiment){var xp_ind=document.body.getElementsByClassName("nav-level")[0],points=+xp_ind.innerHTML.slice(0,-2);if(0!=points){let a=xp_levels[0],b=0;for(;points>xp_levels[b];)a=xp_levels[b+1],b++;xp_ind.innerHTML=points+"XP ["+(a-points)+"]"}}if(experiment){var useless_image=document.body.getElementsByClassName("if-mobile")[1];useless_image.innerHTML="",styles+=scroll_custom_style}styles&&(document.head.innerHTML+="<style> "+styles+" </style>");function autoloading_toggle(){var a=autoloading_toggler.checked?"1":"0";setCookie("settings_autoloading",a)}function experimental_toggle(){var a=experimental_toggler.checked?"1":"0";setCookie("settings_experimental",a),location.reload()}function yt_start(){src=document.body.getElementsByClassName("plyr__video-wrapper")[0].children[0].src,src="https://youtu.be/"+src.split("embed")[1].split("?")[0],open(src)}function yt_download(){src=document.body.getElementsByClassName("plyr__video-wrapper")[0].children[0].src,src="https://ssyoutube.com/watch?v="+src.split("embed/")[1].split("?")[0],open(src)}function getCookie(a){var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):void 0}function setCookie(a,b){var c=encodeURIComponent(a)+"="+encodeURIComponent(b);c+="; path=/; domain=umschool.net; expires=Fri, 31 Dec 9999 23:59:59 GMT;",document.cookie=c}function deleteCookie(a){setCookie(a,"",{"max-age":-1})}